<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/html">
<head th:replace="fragments/common :: head('삐슐랭가이드 : 지도')">
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link href="cover.css" rel="stylesheet">
    <title>삐슐랭가이드</title>
</head>
<body>
<nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark" th:replace="fragments/common :: menu('home')"></nav>
<main>
    <div class="p-5 mb-4 bg-light rounded-3">
        <div class="container-fluid py-5">
            <div class="starter-template">
                <h1 class="display-5 fw-bold">삐슐랭 MAP</h1>
                <div id="map" style="width:1270px;height:500px;"></div>
                <br>
                <p>삐슐랭 가이드의 분포를 살펴보세요</p>
        </div>
    </div>
    <div class="container">
        <div class="row align-items-md-stretch">
            <div class="col-md-6">
                <div class="h-100 p-5 text-white bg-dark rounded-3">
                    <h2>Change the background</h2>
                    <p>Swap the background-color utility and add a `.text-*` color utility to mix up the jumbotron look.
                        Then, mix and match with additional component themes and more.</p>
                    <button class="btn btn-outline-light" type="button">Example button</button>
                </div>
            </div>
            <div class="col-md-6">
                <div class="h-100 p-5 bg-light border rounded-3">
                    <h2>Add borders</h2>
                    <p>Or, keep it light and add a border for some added definition to the boundaries of your content.
                        Be
                        sure to look under the hood at the source HTML here as we've adjusted the alignment and sizing
                        of
                        both column's content for equal-height.</p>
                    <button class="btn btn-outline-secondary" type="button">Example button</button>
                </div>
            </div>
        </div>
    </div>
    </div>
</main>
<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=dbbe2da30ca80968723394ba0f93d23b"></script>
<script th:inline="javascript">
    var mapContainer = document.getElementById('map');
    mapOption = {
        center: new kakao.maps.LatLng(37.4981646510326, 127.028307900881),
        level: 9
    };
    var map = new kakao.maps.Map(mapContainer, mapOption);
    /*<![CDATA[*/
    const storeList = [[${stores}]];
    console.log(storeList);
    /*]]>*/
    var positions = [
        {
            content: '<div>' + "병아리" + '</div>',
            latlng: new kakao.maps.LatLng(37.5060373, 127.0253441),
            id: 1
        },
        {
           // content: '<div>' + storeList[1].name + '</div>',
            content: '<div>' + "찡콩" + '</div>',
            latlng: new kakao.maps.LatLng(37.5061068, 127.0492459),
            id: 2
        },
        {
            content: '<div>' + "사랑해" + '</div>',
            latlng: new kakao.maps.LatLng(37.5519471, 126.9210969),
            id: 3
        },
    ];
    var imageSrc = "https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/markerStar.png";

    for (var i = 0; i < positions.length; i++) {
        var imageSize = new kakao.maps.Size(24, 35);
        var markerImage = new kakao.maps.MarkerImage(imageSrc, imageSize);

        // 마커를 생성
        var marker = new kakao.maps.Marker({
            map: map, // 마커를 표시할 지도
            position: positions[i].latlng, // 마커의 위치
            image: markerImage // 마커 이미지
        });

        // 마커에 표시할 인포윈도우를 생성
        var infowindow = new kakao.maps.InfoWindow({
            content: positions[i].content // 인포윈도우에 표시할 내용
        });

        kakao.maps.event.addListener(marker, 'mouseover', makeOverListener(map, marker, infowindow));
        kakao.maps.event.addListener(marker, 'click', makeClickListener(positions[i].id));
        kakao.maps.event.addListener(marker, 'mouseout', makeOutListener(infowindow));
    }

    function makeOverListener(map, marker, infowindow) {
        return function () {
            infowindow.open(map, marker);
        };
    }

    function getBoard(id) {
        //POST /api/boards/{id}
        $.ajax({
            url: '/api/stores/' + id,
            type: 'GET',
            success: function (result) {
                console.log('result', result);
                //window.location.href = '/board/list';
            }
        });
    }

    function makeClickListener(id) {
        return function () {
            window.location.href = '/board/information/';
        };
    }


    function makeOutListener(infowindow) {
        return function () {
            infowindow.close();
        };
    }
</script>
</body>
</html>